# AutoCAD-ST2TC

AutoCAD中将文字从简体中文转换为繁体中文

在 AutoCAD VBA 中调用 Word 进行简繁转换时，如果返回的文本只有第一个字，而其他字丢失了，可能是由于以下原因之一：

1. Word 的 Selection.Text 属性问题
在 Word 中，Selection.Text 可能会受到光标位置或选择范围的影响，导致只返回部分文本。

解决方法：确保在获取转换后的文本时，选择的范围是正确的。

2. 文本插入和选择的范围问题
如果插入文本后没有正确选择全部内容，可能会导致只转换了部分文本。

解决方法：在插入文本后，使用 SelectAll 方法确保选择整个文档内容。

3. Word 的语言设置问题
如果 Word 的语言设置不正确，可能会导致转换失败或部分文本丢失。

解决方法：确保在转换前正确设置语言。

## **主要修正点**

**选择整个文档内容：**

在插入文本后，使用 wordDoc.Content.Select 确保选择整个文档内容。

**获取转换后的文本**：

使用 selection.Text 获取转换后的文本，确保选择范围正确。

**语言设置：**

设置 selection.LanguageID = 2052，确保语言为简体中文。

**测试步骤**
在 AutoCAD 中运行上述代码。

选择一个文本对象（单行文本或多行文本）。

检查转换后的文本是否完整。

## 注意事项

**依赖 Word：**

该代码依赖于 Microsoft Word 的 COM 接口，因此需要安装 Word。

**语言支持：**

确保 Word 安装了中文语言包，否则简繁转换功能可能不可用。

**错误处理：**

代码中包含基本的错误处理，如果 Word 无法创建或文档无法打开，会提示错误信息。
